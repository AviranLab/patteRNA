2021-08-24 21:54 - INFO - cli : 31 - Summarizing job ... 

       Input files:
              probing: sample_data/weeks_set.shape
              fasta: data_store/weeks_set_20200826/weeks_set.fa

       Configuration parameters:
              log: False
              training: True
              scoring: True
              k: auto
              DOM: True
              motif: ((((....))))

       Using 8 parallel processes

2021-08-24 21:54 - DEBUG - cli : 32 - Summarizing configuration:
=========================================================
Running patteRNA mining with the following parameters:
=========================================================
Input files:
	probing: sample_data/weeks_set.shape
	fasta: data_store/weeks_set_20200826/weeks_set.fa

Configuration parameters:
	output: sample_data/sample_output/
	verbose: True
	log: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 8
	config: None
	motif: ((((....))))
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	training: True
	scoring: True
	reference: False
=========================================================
2021-08-24 21:54 - INFO - cli : 42 - Loading input data
2021-08-24 21:54 - INFO - cli : 58 -  ... done in 00:00:00
2021-08-24 21:54 - INFO - cli : 95 - Spawning training set
2021-08-24 21:54 - INFO - cli : 98 -  ... done in 00:00:00
2021-08-24 21:54 - INFO - cli : 108 - Training set summary: 
       Passed QC                  22
       Used transcripts           7
       # Data points (in DOM)     5159
       KL div                     0.000996
2021-08-24 21:54 - INFO - TrainingManager : 102 - Training with k=6
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=6) EM iteration #1
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11639123 0.04780851 0.0580127  0.06833124 0.07933467 0.08986807
  0.10066441 0.33958917 0.1       ]
 [0.33585177 0.10282716 0.09056692 0.08168415 0.07009443 0.05933443
  0.04955912 0.11008201 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 0: logL = -11521.0
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=6) EM iteration #2
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.76 0.24]
 [0.23 0.77]]
chi:
[[0.07629892 0.03410902 0.04890106 0.06236802 0.08034134 0.09831103
  0.11214234 0.38752827 0.1       ]
 [0.3854262  0.1113363  0.09683186 0.08340292 0.06772049 0.05284643
  0.03883937 0.06359644 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 1: logL = -10644.0
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=6) EM iteration #3
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.81 0.19]
 [0.18 0.82]]
chi:
[[0.03960058 0.02144113 0.03873804 0.05704022 0.08205251 0.10741229
  0.12500544 0.42870979 0.1       ]
 [0.41913438 0.12219969 0.10535999 0.08792808 0.06566627 0.04419721
  0.02731503 0.02819936 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 2: logL = -10407.6
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=6) EM iteration #4
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.0196847  0.01297793 0.03016724 0.05244939 0.08300231 0.11527873
  0.1350769  0.45136279 0.1       ]
 [0.43726839 0.12860122 0.11147891 0.09135795 0.06404164 0.03678391
  0.01887047 0.0115975  0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 3: logL = -10179.2
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=6) EM iteration #5
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.49 0.51]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.01133014 0.00873507 0.02485677 0.0496143  0.08326061 0.12035524
  0.14089521 0.46095266 0.1       ]
 [0.44538375 0.13147665 0.11487905 0.09326039 0.06323659 0.03209586
  0.01418157 0.00548614 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 4: logL = -10077.9
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=6) EM iteration #6
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.49 0.51]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.00747799 0.00652723 0.02165957 0.04788528 0.08334375 0.12362539
  0.14422117 0.46525962 0.1       ]
 [0.44893325 0.13293539 0.11697294 0.09439634 0.06294497 0.02930012
  0.01156726 0.00294973 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 5: logL = -10049.5
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=6) EM iteration #7
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.00528718 0.00516913 0.01952152 0.04665538 0.08338881 0.12591233
  0.14639194 0.46767371 0.1       ]
 [0.45056425 0.13382268 0.1184356  0.09522106 0.06286508 0.02750023
  0.00991489 0.0016762  0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 6: logL = -10038.5
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=6) EM iteration #8
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.51 0.49]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.00385765 0.00422628 0.01796677 0.04568761 0.08340135 0.12758473
  0.14796523 0.46931038 0.1       ]
 [0.4513379  0.1344068  0.11950478 0.09587913 0.06287028 0.02626277
  0.00876811 0.00097023 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 7: logL = -10032.3
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=6) EM iteration #9
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.51 0.49]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.0028604  0.00352832 0.01678582 0.04489765 0.08337833 0.12882838
  0.14917    0.4705511  0.1       ]
 [0.45167525 0.13480186 0.12029919 0.09641709 0.06292012 0.02538908
  0.00793273 0.00056469 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 8: logL = -10028.4
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=6) EM iteration #10
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[2.14122436e-03 2.99249049e-03 1.58677882e-02 4.42452511e-02
  8.33217814e-02 1.29757484e-01 1.50119849e-01 4.71554131e-01
  1.00000000e-01]
 [4.51766244e-01 1.35071819e-01 1.20894913e-01 9.68585115e-02
  6.30001388e-02 2.47707389e-02 7.30854351e-03 3.29090306e-04
  1.00000000e-01]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 9: logL = -10025.9
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=6) EM iteration #11
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[1.61265996e-03 2.57069665e-03 1.51430512e-02 4.37030154e-02
  8.32368705e-02 1.30451378e-01 1.50882827e-01 4.72399501e-01
  1.00000000e-01]
 [4.51709809e-01 1.35256792e-01 1.21345069e-01 9.72214409e-02
  6.31024045e-02 2.43378517e-02 6.83483656e-03 1.91795893e-04
  1.00000000e-01]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 10: logL = -10024.3
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=6) EM iteration #12
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[1.21945682e-03 2.23203416e-03 1.45635748e-02 4.32491905e-02
  8.31298137e-02 1.30968212e-01 1.51504456e-01 4.73133262e-01
  1.00000000e-01]
 [4.51563082e-01 1.35382933e-01 1.21687600e-01 9.75212343e-02
  6.32207611e-02 2.40412152e-02 6.47142833e-03 1.11745898e-04
  1.00000000e-01]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 11: logL = -10023.1
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=6) EM iteration #13
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[9.24547265e-04 1.95553743e-03 1.40947909e-02 4.28660878e-02
  8.30066319e-02 1.31351491e-01 1.52016953e-01 4.73783960e-01
  1.00000000e-01]
 [4.51361236e-01 1.35467663e-01 1.21949863e-01 9.77707215e-02
  6.33500108e-02 2.38449247e-02 6.19049504e-03 6.50862090e-05
  1.00000000e-01]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 12: logL = -10022.3
2021-08-24 21:54 - INFO - TrainingManager : 150 -  >> Log-likelihood of converged model with k=6: -1.002e+04
2021-08-24 21:54 - INFO - TrainingManager : 73 -  >> BIC: 2.017e+04
2021-08-24 21:54 - INFO - TrainingManager : 102 - Training with k=7
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=7) EM iteration #1
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.53 0.47]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11542855 0.03965389 0.04772828 0.05540368 0.06372898 0.07151133
  0.07893846 0.08771639 0.33989045 0.1       ]
 [0.33428358 0.0891144  0.08089171 0.07291658 0.06494846 0.0571681
  0.04910216 0.04140438 0.11017063 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 0: logL = -12127.3
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=7) EM iteration #2
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.53 0.47]
A:
[[0.76 0.24]
 [0.23 0.77]]
chi:
[[0.07550993 0.02767393 0.03821727 0.0497962  0.06221358 0.07370341
  0.08645895 0.0985303  0.38789643 0.1       ]
 [0.38503372 0.09637812 0.08653319 0.07588688 0.06429783 0.05367894
  0.04296536 0.0317821  0.06344387 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 1: logL = -11038.3
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=7) EM iteration #3
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.81 0.19]
 [0.18 0.82]]
chi:
[[0.03881066 0.01691232 0.02854718 0.0437902  0.0612928  0.07718477
  0.0948391  0.10982817 0.42879481 0.1       ]
 [0.41824909 0.10569669 0.09507239 0.08091372 0.0649442  0.05028697
  0.03516092 0.02158814 0.02808788 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 2: logL = -10798.5
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=7) EM iteration #4
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.51 0.49]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.01914092 0.00998476 0.02099779 0.03844741 0.06001565 0.08003575
  0.10219641 0.11817758 0.45100371 0.1       ]
 [0.43571967 0.11096366 0.10092096 0.08478289 0.06563327 0.0473449
  0.02852016 0.01447962 0.01163486 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 3: logL = -10569.5
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=7) EM iteration #5
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.51 0.49]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[0.01096368 0.00663545 0.01666886 0.03502906 0.05872712 0.08182357
  0.10705313 0.12272906 0.46037006 0.1       ]
 [0.443773   0.11312194 0.10378781 0.08700885 0.06629122 0.04538393
  0.02428497 0.01075106 0.00559722 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 4: logL = -10470.0
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=7) EM iteration #6
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.51 0.49]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.0072097  0.00493968 0.01423105 0.03298957 0.05764104 0.0830466
  0.11018027 0.1252545  0.46450757 0.1       ]
 [0.44766807 0.11415911 0.10521594 0.08840326 0.06691722 0.04409118
  0.02171783 0.0087544  0.00307298 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 5: logL = -10442.8
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=7) EM iteration #7
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.00508304 0.00390948 0.01269914 0.03165521 0.05676329 0.08399213
  0.11233001 0.12688312 0.46668458 0.1       ]
 [0.44971561 0.11482822 0.10606354 0.0894115  0.06748647 0.04315952
  0.02004336 0.00750648 0.00178531 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 6: logL = -10432.7
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=7) EM iteration #8
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.00370137 0.00319537 0.01164725 0.03070261 0.05605874 0.08474833
  0.11387761 0.12804974 0.46801898 0.1       ]
 [0.4508955  0.11531327 0.10662959 0.0901723  0.06797456 0.0424486
  0.01887604 0.0066333  0.00105685 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 7: logL = -10427.1
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=7) EM iteration #9
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.53 0.47]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.00274142 0.00266542 0.01088954 0.02999282 0.05549535 0.08535102
  0.11501866 0.12892963 0.46891614 0.1       ]
 [0.45161998 0.11567673 0.10702826 0.09074953 0.0683785  0.04189775
  0.01803338 0.00598691 0.00062898 0.1       ]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 8: logL = -10423.6
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=7) EM iteration #10
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.53 0.47]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[2.05150457e-03 2.25745483e-03 1.03298777e-02 2.94547135e-02
  5.50460823e-02 8.58256425e-02 1.15870325e-01 1.29610737e-01
  4.69553663e-01 1.00000000e-01]
 [4.52079092e-01 1.15954239e-01 1.07315845e-01 9.11872790e-02
  6.87067894e-02 4.14722307e-02 1.74153263e-02 5.49451207e-03
  3.74686613e-04 1.00000000e-01]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 9: logL = -10421.4
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=7) EM iteration #11
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.54 0.46]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[1.54582317e-03 1.93577883e-03 9.91018542e-03 2.90434422e-02
  5.46880864e-02 8.61949184e-02 1.16510418e-01 1.30146498e-01
  4.70024849e-01 1.00000000e-01]
 [4.52372293e-01 1.16169926e-01 1.07526084e-01 9.15193547e-02
  6.89715009e-02 4.11463133e-02 1.69587210e-02 5.11271752e-03
  2.23090191e-04 1.00000000e-01]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 10: logL = -10420.0
2021-08-24 21:54 - DEBUG - TrainingManager : 111 - (k=7) EM iteration #12
2021-08-24 21:54 - DEBUG - TrainingManager : 131 - Current model parameters
pi:
[0.54 0.46]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[1.17039333e-03 1.67743947e-03 9.59201449e-03 2.87272412e-02
  5.44023356e-02 8.64792219e-02 1.16993662e-01 1.30573025e-01
  4.70384667e-01 1.00000000e-01]
 [4.52557204e-01 1.16340494e-01 1.07681186e-01 9.17717740e-02
  6.91845607e-02 4.08990518e-02 1.66202841e-02 4.81274327e-03
  1.32702845e-04 1.00000000e-01]]

2021-08-24 21:54 - DEBUG - TrainingManager : 132 - 11: logL = -10419.0
2021-08-24 21:54 - INFO - TrainingManager : 150 -  >> Log-likelihood of converged model with k=7: -1.042e+04
2021-08-24 21:54 - INFO - TrainingManager : 73 -  >> BIC: 2.098e+04
2021-08-24 21:54 - INFO - TrainingManager : 77 - Optimal k=6
2021-08-24 21:54 - INFO - cli : 116 - Training phase done in 00:00:03
2021-08-24 21:54 - INFO - cli : 127 - Initiating scoring phase
2021-08-24 21:54 - INFO - cli : 138 - Scoring set summary: 
       Passed QC                  22
       Used transcripts           22
       # Data points              10690
       # Motifs                   1
2021-08-24 21:54 - INFO - ScoringManager : 66 - Sampling null sites for c-score normalization
2021-08-24 21:54 - INFO - ScoringManager : 96 -  ... done in 00:00:00
2021-08-24 21:54 - INFO - ScoringManager : 107 - Executing scoring
2021-08-24 21:54 - INFO - ScoringManager : 156 -  ... done in 00:00:00
2021-08-24 21:54 - INFO - cli : 144 - Scoring phase done in 00:00:00
2021-08-24 21:54 - INFO - cli : 146 - Process done in 00:00:03
2021-08-24 21:54 - INFO - cli : 147 - Output written to  -> sample_data/sample_output/
