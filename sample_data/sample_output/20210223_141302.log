2021-02-23 14:13 - INFO - cli : 30 - Summarizing job ... 

       Input files:
              probing: sample_data/weeks_set.shape
              fasta: sample_data/weeks_set.fa

       Configuration parameters:
              log: False
              training: True
              scoring: True
              k: auto
              DOM: True
              motif: ((((...))))

       Using 8 parallel processes

2021-02-23 14:13 - DEBUG - cli : 31 - Summarizing configuration:
=========================================================
Running patteRNA mining with the following parameters:
=========================================================
Input files:
	probing: sample_data/weeks_set.shape
	fasta: sample_data/weeks_set.fa

Configuration parameters:
	output: sample_data/sample_output
	verbose: True
	log: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 8
	config: None
	motif: ((((...))))
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	nan: False
	no_prompt: False
	GMM: False
	no_cscores: False
	min_cscores: 1000
	batch_size: 100
	training: True
	scoring: True
=========================================================
2021-02-23 14:13 - INFO - cli : 40 - Loading input data
2021-02-23 14:13 - INFO - cli : 43 -  ... done in 00:00:00
2021-02-23 14:13 - INFO - cli : 56 - Spawning training set
2021-02-23 14:13 - INFO - cli : 59 -  ... done in 00:00:00
2021-02-23 14:13 - INFO - cli : 69 - Training set summary: 
       Passed QC                  22
       Used transcripts           9
       # Data points (in DOM)     6726
       KL div                     0.000798
2021-02-23 14:13 - INFO - TrainingManager : 92 - Training with k=6
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #1
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.06967076 0.08347809 0.10531078 0.12648239 0.14939118 0.17264098
  0.19302582 0.1       ]
 [0.18998762 0.17384076 0.1519659  0.12982972 0.10656241 0.08324311
  0.06457049 0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 0: logL = -14150.9
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #2
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.51 0.49]
A:
[[0.75 0.25]
 [0.25 0.75]]
chi:
[[0.04934765 0.06087696 0.09127488 0.12375466 0.16040297 0.19527605
  0.21906684 0.1       ]
 [0.20911754 0.19548986 0.16550592 0.13250159 0.09598995 0.06150584
  0.03988932 0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 1: logL = -14028.4
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #3
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.51 0.49]
A:
[[0.79 0.21]
 [0.2  0.8 ]]
chi:
[[0.03008017 0.03661676 0.07226649 0.11994072 0.17585199 0.22153292
  0.24371094 0.1       ]
 [0.22508369 0.21688453 0.18263702 0.13601892 0.08208799 0.03818507
  0.01910278 0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 2: logL = -13800.3
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #4
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.49 0.51]
A:
[[0.82 0.18]
 [0.17 0.83]]
chi:
[[0.01713394 0.01895648 0.05275205 0.11519174 0.19211059 0.24331832
  0.26053688 0.1       ]
 [0.233366   0.23072714 0.19862353 0.14004499 0.06852679 0.02091781
  0.00779373 0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 3: logL = -13511.5
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #5
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.01075524 0.01007326 0.03854942 0.11060272 0.20395435 0.25631214
  0.26975285 0.1       ]
 [0.23571086 0.23701197 0.20907783 0.14366943 0.05931609 0.01185694
  0.00335688 0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 4: logL = -13312.6
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #6
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.46 0.54]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[0.00778081 0.00599495 0.02970393 0.10677552 0.21117353 0.26361463
  0.27495664 0.1       ]
 [0.23576629 0.23935639 0.21490604 0.14657307 0.05420146 0.00754818
  0.00164857 0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 5: logL = -13235.2
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #7
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.45 0.55]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.0061237  0.00386236 0.02401303 0.10353866 0.21574076 0.26835349
  0.278368   0.1       ]
 [0.23528314 0.2399796  0.21827037 0.14898267 0.05135423 0.00525547
  0.00087453 0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 6: logL = -13207.3
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #8
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.45 0.55]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[0.00500589 0.0025831  0.02007465 0.10071326 0.21887991 0.27184191
  0.28090127 0.1       ]
 [0.23471582 0.2398924  0.22034265 0.15105196 0.04966236 0.00385692
  0.0004779  0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 7: logL = -13193.4
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #9
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.45 0.55]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[4.16777255e-03 1.75523361e-03 1.71957998e-02 9.82245251e-02
  2.21146972e-01 2.74586663e-01 2.82923034e-01 1.00000000e-01]
 [2.34163533e-01 2.39507514e-01 2.21672941e-01 1.52842217e-01
  4.86249530e-02 2.92489201e-03 2.63950695e-04 1.00000000e-01]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 8: logL = -13185.1
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #10
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.45 0.55]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[3.50876738e-03 1.20041314e-03 1.50124373e-02 9.60364544e-02
  2.22815761e-01 2.76823821e-01 2.84602346e-01 1.00000000e-01]
 [2.33648066e-01 2.38998624e-01 2.22546419e-01 1.54387174e-01
  4.80029446e-02 2.27028880e-03 1.46483708e-04 1.00000000e-01]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 9: logL = -13179.8
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #11
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.45 0.55]
A:
[[0.81 0.19]
 [0.15 0.85]]
chi:
[[2.97830993e-03 8.22628507e-04 1.33111774e-02 9.41199280e-02
  2.24048776e-01 2.78687715e-01 2.86031465e-01 1.00000000e-01]
 [2.33173265e-01 2.38446649e-01 2.23126856e-01 1.55715857e-01
  4.76615169e-02 1.79430107e-03 8.15539982e-05 1.00000000e-01]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 10: logL = -13176.2
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #12
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.46 0.54]
A:
[[0.81 0.19]
 [0.15 0.85]]
chi:
[[2.54502288e-03 5.63560839e-04 1.19563852e-02 9.24456105e-02
  2.24957101e-01 2.80265009e-01 2.87267311e-01 1.00000000e-01]
 [2.32738336e-01 2.37892566e-01 2.23514588e-01 1.56856395e-01
  4.75134999e-02 1.43908229e-03 4.55329310e-05 1.00000000e-01]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 11: logL = -13173.7
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #13
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.46 0.54]
A:
[[0.81 0.19]
 [0.15 0.85]]
chi:
[[2.18714054e-03 3.85450842e-04 1.08573954e-02 9.09843658e-02
  2.25622047e-01 2.81615664e-01 2.88347936e-01 1.00000000e-01]
 [2.32341126e-01 2.37357894e-01 2.23773503e-01 1.57835292e-01
  4.74983248e-02 1.16837017e-03 2.54910971e-05 1.00000000e-01]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 12: logL = -13171.9
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=6) EM iteration #14
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.46 0.54]
A:
[[0.81 0.19]
 [0.16 0.84]]
chi:
[[1.88876826e-03 2.63005589e-04 9.95155635e-03 8.97087009e-02
  2.26104650e-01 2.82783018e-01 2.89300301e-01 1.00000000e-01]
 [2.31979059e-01 2.36853733e-01 2.23945328e-01 1.58676472e-01
  4.75726952e-02 9.58404096e-04 1.43089394e-05 1.00000000e-01]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 13: logL = -13170.6
2021-02-23 14:13 - INFO - TrainingManager : 140 -  >> Log-likelihood of converged model with k=6: -1.317e+04
2021-02-23 14:13 - INFO - TrainingManager : 63 -  >> BIC: 2.647e+04
2021-02-23 14:13 - INFO - TrainingManager : 92 - Training with k=7
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #1
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.51 0.49]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.06027258 0.07145047 0.08575266 0.10302691 0.11927239 0.13699927
  0.15467104 0.16855469 0.1       ]
 [0.16301763 0.1559112  0.13960803 0.12280656 0.10441286 0.08766661
  0.0701142  0.05646292 0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 0: logL = -15051.7
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #2
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.53 0.47]
A:
[[0.75 0.25]
 [0.25 0.75]]
chi:
[[0.0432165  0.05115773 0.06959432 0.09591474 0.1225665  0.15016638
  0.17598826 0.19139557 0.1       ]
 [0.1788969  0.17547081 0.1552182  0.12967355 0.10124604 0.07500854
  0.04969125 0.0347947  0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 1: logL = -14930.2
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #3
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.54 0.46]
A:
[[0.79 0.21]
 [0.2  0.8 ]]
chi:
[[0.02689399 0.0297789  0.04935368 0.08582187 0.12733946 0.16811906
  0.19968821 0.21300484 0.1       ]
 [0.1921212  0.19444002 0.17349844 0.13881605 0.09693374 0.05886853
  0.02883248 0.01648956 0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 2: logL = -14698.9
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #4
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.53 0.47]
A:
[[0.82 0.18]
 [0.17 0.83]]
chi:
[[0.01584303 0.01465437 0.03143871 0.07434402 0.13213327 0.18631007
  0.21794849 0.22732804 0.1       ]
 [0.19882842 0.20658662 0.18830702 0.14847509 0.09287449 0.04372171
  0.01461649 0.00659017 0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 3: logL = -14401.2
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #5
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.01045838 0.00732495 0.02066219 0.06491748 0.1350662  0.19915363
  0.22784435 0.23457281 0.1       ]
 [0.20056144 0.21230333 0.19639258 0.15593882 0.09052293 0.03367234
  0.00781482 0.00279373 0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 4: logL = -14197.1
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #6
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.48 0.52]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.00802207 0.00408964 0.01504993 0.0583861  0.13622358 0.20688275
  0.23296703 0.23837892 0.1       ]
 [0.20054038 0.2147297  0.20001397 0.1608296  0.08970358 0.02803535
  0.00477532 0.0013721  0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 5: logL = -14121.2
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #7
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.0066981  0.00245829 0.01186743 0.05374869 0.13641565 0.21179715
  0.23619009 0.2408246  0.1       ]
 [0.20020059 0.21558238 0.20164216 0.16413961 0.08972541 0.02477835
  0.0031959  0.0007356  0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 6: logL = -14095.8
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #8
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.00580049 0.00152126 0.0098055  0.05022446 0.13613317 0.21525556
  0.23858601 0.24267356 0.1       ]
 [0.19981952 0.21570022 0.20240517 0.16654032 0.09015403 0.02273289
  0.00223978 0.00040808 0.1       ]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 7: logL = -14083.8
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #9
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[5.10881863e-03 9.48419123e-04 8.33682865e-03 4.74235755e-02
  1.35602894e-01 2.17858962e-01 2.40519163e-01 2.44201339e-01
  1.00000000e-01]
 [1.99430421e-01 2.15475237e-01 2.02745653e-01 1.68355412e-01
  9.07799806e-02 2.13749015e-02 1.60918827e-03 2.29205137e-04
  1.00000000e-01]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 8: logL = -14076.7
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #10
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[4.54561609e-03 5.90575629e-04 7.22913097e-03 4.51424959e-02
  1.34937936e-01 2.19890259e-01 2.42142143e-01 2.45521843e-01
  1.00000000e-01]
 [1.99041771e-01 2.15086174e-01 2.02855859e-01 1.69757436e-01
  9.14999387e-02 2.04545036e-02 1.17488010e-03 1.29436838e-04
  1.00000000e-01]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 9: logL = -14072.3
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #11
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[4.07566550e-03 3.66061615e-04 6.36243390e-03 4.32560374e-02
  1.34203581e-01 2.21506763e-01 2.43537371e-01 2.46692087e-01
  1.00000000e-01]
 [1.98660182e-01 2.14620876e-01 2.02832256e-01 1.70854419e-01
  9.22569969e-02 1.98337154e-02 8.68198196e-04 7.33565899e-05
  1.00000000e-01]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 10: logL = -14069.3
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #12
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.81 0.19]
 [0.15 0.85]]
chi:
[[3.67798344e-03 2.25563264e-04 5.66603703e-03 4.16771267e-02
  1.33441365e-01 2.22809449e-01 2.44757123e-01 2.47745353e-01
  1.00000000e-01]
 [1.98290684e-01 2.14126302e-01 2.02728880e-01 1.71721287e-01
  9.30170475e-02 1.94262049e-02 6.47887760e-04 4.17075238e-05
  1.00000000e-01]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 11: logL = -14067.3
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #13
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.81 0.19]
 [0.15 0.85]]
chi:
[[3.33788515e-03 1.38117224e-04 5.09458403e-03 4.03414239e-02
  1.32678616e-01 2.23869035e-01 2.45837288e-01 2.48703051e-01
  1.00000000e-01]
 [1.97936546e-01 2.13628854e-01 2.02578181e-01 1.72412546e-01
  9.37590645e-02 1.91735157e-02 4.87501534e-04 2.37905046e-05
  1.00000000e-01]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 12: logL = -14065.9
2021-02-23 14:13 - DEBUG - TrainingManager : 101 - (k=7) EM iteration #14
2021-02-23 14:13 - DEBUG - TrainingManager : 121 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.81 0.19]
 [0.15 0.85]]
chi:
[[3.04436766e-03 8.40456203e-05 4.61740650e-03 3.92001606e-02
  1.31933156e-01 2.24737470e-01 2.46803537e-01 2.49579856e-01
  1.00000000e-01]
 [1.97599637e-01 2.13143556e-01 2.02400507e-01 1.72968676e-01
  9.44703530e-02 1.90342043e-02 3.69450420e-04 1.36161497e-05
  1.00000000e-01]]

2021-02-23 14:13 - DEBUG - TrainingManager : 122 - 13: logL = -14064.8
2021-02-23 14:13 - INFO - TrainingManager : 140 -  >> Log-likelihood of converged model with k=7: -1.406e+04
2021-02-23 14:13 - INFO - TrainingManager : 63 -  >> BIC: 2.828e+04
2021-02-23 14:13 - INFO - TrainingManager : 67 - Optimal k=6
2021-02-23 14:13 - INFO - cli : 76 - Training phase done in 00:00:03
2021-02-23 14:13 - INFO - cli : 85 - Initiating scoring phase
2021-02-23 14:13 - INFO - cli : 96 - Scoring set summary: 
       Passed QC                  22
       Used transcripts           22
       # Data points              10690
       # Motifs                   1
2021-02-23 14:13 - INFO - ScoringManager : 63 - Sampling null sites for c-score normalization
2021-02-23 14:13 - INFO - ScoringManager : 93 -  ... done in 00:00:00
2021-02-23 14:13 - INFO - ScoringManager : 103 - Executing scoring
2021-02-23 14:13 - INFO - ScoringManager : 148 -  ... done in 00:00:00
2021-02-23 14:13 - INFO - cli : 102 - Scoring phase done in 00:00:00
2021-02-23 14:13 - INFO - cli : 104 - Process done in 00:00:04
2021-02-23 14:13 - INFO - cli : 105 - Output written to  -> sample_data/sample_output
