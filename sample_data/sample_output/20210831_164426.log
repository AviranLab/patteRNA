2021-08-31 16:44 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: sample_data/weeks_set.shape
              fasta: sample_data/weeks_set.fa

       Configuration parameters:
              log: False
              training: True
              scoring: True
              k: auto
              DOM: True
              motif: ((((...))))

       Using 8 parallel processes

2021-08-31 16:44 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: sample_data/weeks_set.shape
	fasta: sample_data/weeks_set.fa

Configuration parameters:
	output: sample_output
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 8
	motif: ((((...))))
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: True
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2021-08-31 16:44 - INFO - cli : 50 - Loading input data
2021-08-31 16:44 - INFO - cli : 66 -  ... done in 00:00:00
2021-08-31 16:44 - INFO - cli : 104 - Spawning training set
2021-08-31 16:44 - INFO - Dataset : 104 -  ... sorting
2021-08-31 16:44 - INFO - Dataset : 107 -  ... selecting
2021-08-31 16:44 - INFO - cli : 107 -  ... done in 00:00:00
2021-08-31 16:44 - INFO - cli : 117 - Training set summary: 
       Passed QC                  22
       Used transcripts           20
       # Data points (in DOM)     9170
       KL div                     0.000276
2021-08-31 16:44 - INFO - TrainingManager : 104 - Training with k=6
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11632822 0.0490797  0.05662381 0.0683632  0.07979244 0.09054792
  0.09967597 0.33958873 0.1       ]
 [0.3356669  0.10366504 0.08864945 0.08185375 0.07000191 0.05950499
  0.04931446 0.1113435  0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 0: logL = -20403.3
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.51 0.49]
A:
[[0.76 0.24]
 [0.23 0.77]]
chi:
[[0.07894239 0.03613179 0.04556811 0.05998954 0.0845675  0.09845874
  0.10838092 0.38796101 0.1       ]
 [0.39090945 0.11092561 0.09057552 0.08130724 0.06939087 0.05298849
  0.03804048 0.06586234 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 1: logL = -18846.7
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.48 0.52]
A:
[[0.81 0.19]
 [0.18 0.82]]
chi:
[[0.04307153 0.02416062 0.03532357 0.0534777  0.08812067 0.10720657
  0.11979682 0.42884252 0.1       ]
 [0.42583279 0.12073357 0.09812235 0.08615371 0.06706325 0.04508058
  0.02690236 0.03011141 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 2: logL = -18450.7
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.44 0.56]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.02355867 0.01601407 0.02642297 0.04738824 0.0913142  0.1146108
  0.12871537 0.45197568 0.1       ]
 [0.44439818 0.12650792 0.10401593 0.09021175 0.06538714 0.03856601
  0.01849346 0.01241962 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 3: logL = -18059.9
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.4 0.6]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[0.01524966 0.01189055 0.02077357 0.04338369 0.09313442 0.11919342
  0.13410372 0.46227097 0.1       ]
 [0.45199814 0.12900707 0.10766899 0.09276846 0.06463035 0.0346478
  0.01368171 0.00559749 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 4: logL = -17879.8
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.39 0.61]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[0.01127988 0.00975547 0.01738394 0.04098058 0.09390093 0.12198497
  0.13741155 0.46730268 0.1       ]
 [0.45497926 0.13020297 0.10995445 0.09435637 0.06434855 0.03237622
  0.01100406 0.00277813 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 5: logL = -17826.9
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.39 0.61]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.00886824 0.00843523 0.01518352 0.03940495 0.09417291 0.12391611
  0.13967453 0.47034451 0.1       ]
 [0.45619782 0.13091186 0.11147555 0.09543387 0.06428142 0.03090054
  0.009359   0.00143994 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 6: logL = -17806.2
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.39 0.61]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.00715887 0.00749881 0.01364282 0.03827146 0.09423053 0.12537108
  0.14134285 0.47248359 0.1       ]
 [0.45670179 0.13137957 0.11252113 0.09620895 0.06432592 0.02985257
  0.00825282 0.00075726 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 7: logL = -17794.4
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.4 0.6]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[5.86067857e-03 6.78653401e-03 1.25115268e-02 3.74131682e-02
  9.41863410e-02 1.26501913e-01 1.42622183e-01 4.74117655e-01
  1.00000000e-01]
 [4.56883120e-01 1.31701277e-01 1.13253810e-01 9.67816783e-02
  6.44324955e-02 2.90807692e-02 7.46682158e-03 4.00028603e-04
  1.00000000e-01]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 8: logL = -17786.8
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.41 0.59]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[4.84316625e-03 6.22562361e-03 1.16556829e-02 3.67463371e-02
  9.40899751e-02 1.27386588e-01 1.43625279e-01 4.75427348e-01
  1.00000000e-01]
 [4.56904015e-01 1.31927365e-01 1.13775606e-01 9.72108198e-02
  6.45722438e-02 2.85081987e-02 6.89010681e-03 2.11644421e-04
  1.00000000e-01]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 9: logL = -17781.8
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.42 0.58]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[4.03107179e-03 5.77458368e-03 1.09943164e-02 3.62199373e-02
  9.39674129e-02 1.28077762e-01 1.44423655e-01 4.76511261e-01
  1.00000000e-01]
 [4.56839676e-01 1.32088615e-01 1.14152591e-01 9.75357948e-02
  6.47269690e-02 2.80857942e-02 6.45848814e-03 1.12071910e-04
  1.00000000e-01]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 10: logL = -17778.3
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.42 0.58]
A:
[[0.83 0.17]
 [0.16 0.84]]
chi:
[[3.37450444e-03 5.40620786e-03 1.04745153e-02 3.57988250e-02
  9.38338403e-02 1.28616011e-01 1.45066506e-01 4.77429591e-01
  1.00000000e-01]
 [4.56728413e-01 1.32204820e-01 1.14428236e-01 9.77845587e-02
  6.48852431e-02 2.77780340e-02 6.13130211e-03 5.93939229e-05
  1.00000000e-01]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 11: logL = -17775.9
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.43 0.57]
A:
[[0.83 0.17]
 [0.16 0.84]]
chi:
[[2.83820370e-03 5.10140274e-03 1.00600678e-02 3.54575076e-02
  9.36983888e-02 1.29033709e-01 1.45589120e-01 4.78221601e-01
  1.00000000e-01]
 [4.56591145e-01 1.32289053e-01 1.14631618e-01 9.79772761e-02
  6.50401773e-02 2.75579292e-02 5.88129564e-03 3.15056348e-05
  1.00000000e-01]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 12: logL = -17774.1
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #14
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.43 0.57]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[2.39640536e-03 4.84630673e-03 9.72543908e-03 3.51771618e-02
  9.35664137e-02 1.29356715e-01 1.46017452e-01 4.78914107e-01
  1.00000000e-01]
 [4.56439896e-01 1.32350153e-01 1.14782573e-01 9.81285567e-02
  6.51879023e-02 2.74046913e-02 5.68949791e-03 1.67294972e-05
  1.00000000e-01]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 13: logL = -17772.8
2021-08-31 16:44 - INFO - TrainingManager : 152 -  >> Log-likelihood of converged model with k=6: -1.777e+04
2021-08-31 16:44 - INFO - TrainingManager : 71 -  >> BIC: 3.568e+04
2021-08-31 16:44 - INFO - TrainingManager : 104 - Training with k=7
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11588897 0.04002506 0.04733524 0.05550005 0.06366034 0.07158396
  0.07916915 0.08746245 0.33937479 0.1       ]
 [0.3347964  0.08807512 0.08009177 0.07348276 0.06462043 0.05725642
  0.04889326 0.04144648 0.11133736 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 0: logL = -21481.4
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.76 0.24]
 [0.23 0.77]]
chi:
[[0.07896382 0.02758593 0.03733372 0.04758679 0.06202767 0.07725899
  0.08668749 0.09511317 0.38744241 0.1       ]
 [0.39202429 0.09121886 0.08270412 0.07425691 0.06413811 0.055946
  0.04262532 0.03131184 0.06577456 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 1: logL = -19549.0
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.81 0.19]
 [0.18 0.82]]
chi:
[[0.04313801 0.01750737 0.02827943 0.04048232 0.0605825  0.08192541
  0.09504799 0.10503756 0.42799942 0.1       ]
 [0.42715497 0.09864095 0.08994946 0.07967844 0.0652472  0.05267963
  0.03504931 0.02156259 0.03003745 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 2: logL = -19149.8
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.02374141 0.01088702 0.02113589 0.03374006 0.05862148 0.08628864
  0.10226086 0.11246546 0.45085918 0.1       ]
 [0.44572408 0.10224757 0.09508326 0.08450741 0.06681668 0.0499792
  0.02880239 0.01442712 0.01241232 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 3: logL = -18758.3
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.43 0.57]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[0.01550885 0.00759137 0.01705789 0.02906168 0.05675101 0.08900547
  0.10687826 0.11688769 0.46125779 0.1       ]
 [0.45334664 0.1035112  0.09769838 0.0877436  0.06832156 0.04835878
  0.02496457 0.01043195 0.00562332 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 4: logL = -18579.3
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.42 0.58]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[0.01157275 0.00588318 0.01481791 0.02611633 0.05530237 0.09040556
  0.1097565  0.11965217 0.46649324 0.1       ]
 [0.45637613 0.10418092 0.09899262 0.08980728 0.06947187 0.04744028
  0.0226951  0.00822539 0.00281042 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 5: logL = -18527.0
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.42 0.58]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.00917291 0.00483114 0.01344122 0.0241712  0.05423696 0.09115924
  0.11173838 0.12157654 0.4696724  0.1       ]
 [0.4576399  0.10466672 0.09972789 0.09119891 0.0703119  0.04689936
  0.02121943 0.00686777 0.00146813 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 6: logL = -18506.7
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.43 0.57]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.0074645  0.00409487 0.01250294 0.02280177 0.05344819 0.09160094
  0.11320795 0.12300506 0.4718738  0.1       ]
 [0.4581938  0.10502375 0.10019114 0.09217532 0.07092681 0.04657983
  0.02018063 0.0059503  0.00077842 0.1       ]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 7: logL = -18495.1
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.44 0.56]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[6.16165695e-03 3.54358921e-03 1.18239998e-02 2.17962584e-02
  5.28547335e-02 9.18672711e-02 1.14334431e-01 1.24101533e-01
  4.73516526e-01 1.00000000e-01]
 [4.58434356e-01 1.05281078e-01 1.00496814e-01 9.28750848e-02
  7.13817089e-02 4.64017741e-02 1.94204577e-02 5.29412854e-03
  4.14597727e-04 1.00000000e-01]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 8: logL = -18487.8
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.44 0.56]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[5.13651838e-03 3.11537796e-03 1.13166177e-02 2.10390259e-02
  5.24012380e-02 9.20225575e-02 1.15208752e-01 1.24960112e-01
  4.74799801e-01 1.00000000e-01]
 [4.58521946e-01 1.05466158e-01 1.00702199e-01 9.33839324e-02
  7.17226997e-02 4.63171279e-02 1.88559967e-02 4.80879459e-03
  2.21146442e-04 1.00000000e-01]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 9: logL = -18482.9
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.45 0.55]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[4.31513237e-03 2.77462721e-03 1.09298788e-02 2.04587329e-02
  5.20493680e-02 9.21042071e-02 1.15890515e-01 1.25642205e-01
  4.75835334e-01 1.00000000e-01]
 [4.58528530e-01 1.05600508e-01 1.00840868e-01 9.37584564e-02
  7.19822479e-02 4.62939609e-02 1.84354796e-02 4.44190101e-03
  1.18048971e-04 1.00000000e-01]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 10: logL = -18479.7
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.46 0.54]
A:
[[0.83 0.17]
 [0.16 0.84]]
chi:
[[3.64826314e-03 2.49834517e-03 1.06307280e-02 2.00076259e-02
  5.17719641e-02 9.21369079e-02 1.16423324e-01 1.26190568e-01
  4.76692274e-01 1.00000000e-01]
 [4.58489696e-01 1.05699272e-01 1.00934087e-01 9.40371259e-02
  7.21832329e-02 4.63103628e-02 1.81229110e-02 4.16025165e-03
  6.30604539e-05 1.00000000e-01]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 11: logL = -18477.4
2021-08-31 16:44 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2021-08-31 16:44 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.46 0.54]
A:
[[0.83 0.17]
 [0.16 0.84]]
chi:
[[3.10098500e-03 2.27076437e-03 1.03963743e-02 1.96522984e-02
  5.15495638e-02 9.21376298e-02 1.16840461e-01 1.26635981e-01
  4.77415942e-01 1.00000000e-01]
 [4.58424430e-01 1.05772741e-01 1.00995863e-01 9.42465640e-02
  7.23417951e-02 4.63513236e-02 1.78919396e-02 3.94162912e-03
  3.37145878e-05 1.00000000e-01]]

2021-08-31 16:44 - DEBUG - TrainingManager : 134 - 12: logL = -18475.7
2021-08-31 16:44 - INFO - TrainingManager : 152 -  >> Log-likelihood of converged model with k=7: -1.848e+04
2021-08-31 16:44 - INFO - TrainingManager : 71 -  >> BIC: 3.711e+04
2021-08-31 16:44 - INFO - TrainingManager : 75 - Optimal k=6
2021-08-31 16:44 - INFO - cli : 125 - Training phase done in 00:00:03
2021-08-31 16:44 - INFO - cli : 137 - Initiating scoring phase
2021-08-31 16:44 - INFO - cli : 147 - Scoring set summary: 
       Passed QC                  22
       Used transcripts           22
       # Data points              10690
       # Motifs                   1
2021-08-31 16:44 - INFO - ScoringManager : 77 - Sampling null sites for c-score normalization
2021-08-31 16:44 - INFO - ScoringManager : 112 -  ... done in 00:00:00
2021-08-31 16:44 - INFO - ScoringManager : 124 - Executing scoring
2021-08-31 16:44 - INFO - ScoringManager : 176 -  ... done in 00:00:00
2021-08-31 16:44 - INFO - cli : 153 - Scoring phase done in 00:00:00
2021-08-31 16:44 - INFO - cli : 155 - Process done in 00:00:04
2021-08-31 16:44 - INFO - cli : 156 - Output written to  -> sample_output
